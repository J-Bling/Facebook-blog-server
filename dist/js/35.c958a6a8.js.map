{"version":3,"file":"js/35.c958a6a8.js","mappings":"kMACSA,MAAM,oB,GADfC,IAAA,EAEaD,MAAM,Y,GAGMA,MAAM,W,GAL/BC,IAAA,EAO4BD,MAAM,gB,GACbA,MAAM,c,GACLA,MAAM,Q,GAWEA,MAAM,iB,iJAnBhCE,EAAAA,EAAAA,IA8BM,MA9BNC,EA8BM,CA7B0BC,EAAAC,SAASC,SAAM,WAA3CJ,EAAAA,EAAAA,IA2BM,MA3BNK,EA2BM,gBA1BFL,EAAAA,EAAAA,IAyBMM,EAAAA,GAAA,MA5BlBC,EAAAA,EAAAA,IAG4DL,EAAAC,UAH5D,CAGyCK,EAASC,M,WAAtCT,EAAAA,EAAAA,IAyBM,OAzBDF,MAAM,UAAgDC,IAAKU,G,CACPD,EAAQE,OAAI,WAAjEC,EAAAA,EAAAA,IAEcC,EAAA,CAN9Bb,IAAA,EAI8Bc,GAAE,SAAWL,EAAQE,MAAMI,KAA0BhB,MAAM,a,CAJzFiB,SAAAC,EAAAA,EAAAA,KAKoB,IAAuD,EAAvDC,EAAAA,EAAAA,IAAuD,MAAvDC,EAAqB,QAAIC,EAAAA,EAAAA,IAAGX,EAAQE,KAAKU,OAAK,MALlEC,EAAA,G,2BAOgBrB,EAAAA,EAAAA,IAA+C,MAA/CsB,EAAiC,cACjCL,EAAAA,EAAAA,IAAyD,MAAzDM,EAAwB,UAAMJ,EAAAA,EAAAA,IAAGX,EAAQgB,SAAO,IAChDP,EAAAA,EAAAA,IAAgE,OAAhEQ,GAAgEN,EAAAA,EAAAA,IAA1CjB,EAAAwB,YAAYlB,EAAQmB,cAAW,IACrDC,EAAAA,EAAAA,IAEYC,EAAA,CAFAC,QAAKC,GAAE7B,EAAA8B,aAAavB,GAAQX,MAAM,c,CAV9DiB,SAAAC,EAAAA,EAAAA,KAU2E,IAE3DiB,EAAA,KAAAA,EAAA,KAZhBC,EAAAA,EAAAA,IAU2E,YAV3Eb,EAAA,G,mBAagBO,EAAAA,EAAAA,IAcYO,EAAA,CAbRf,MAAM,QAd1BgB,WAe6BlC,EAAAmC,cAAc5B,GAf3C,sBAAAsB,GAe6B7B,EAAAmC,cAAc5B,GAAKsB,EAC5BO,MAAM,MACL,eAAYC,IAAQrC,EAAAsC,kBAAkB/B,I,CAE5BgC,QAAMzB,EAAAA,EAAAA,KACb,IAKO,EALPC,EAAAA,EAAAA,IAKO,OALPyB,EAKO,EAJHd,EAAAA,EAAAA,IAA2DC,EAAA,CAA/CC,QAAKC,GAAE7B,EAAAsC,kBAAkB/B,I,CArBjEM,SAAAC,EAAAA,EAAAA,KAqByE,IAAEiB,EAAA,KAAAA,EAAA,KArB3EC,EAAAA,EAAAA,IAqByE,UArBzEb,EAAA,G,mBAsB4BO,EAAAA,EAAAA,IAEeC,EAAA,CAFJc,KAAK,SAAUC,QAAS1C,EAAA2C,UACjCf,QAAKC,GAAE7B,EAAA4C,cAActC,EAAQM,GAAIN,EAAQE,MAAMI,IAAM,IAAKL,I,CAvBxFM,SAAAC,EAAAA,EAAAA,KAwB6B,IAAEiB,EAAA,KAAAA,EAAA,KAxB/BC,EAAAA,EAAAA,IAwB6B,UAxB7Bb,EAAA,G,iCAAAN,SAAAC,EAAAA,EAAAA,KAkBoB,IAAwB,cAAxBC,EAAAA,EAAAA,IAAwB,YAAlB,eAAW,OAlBrCI,EAAA,G,qFA8BQV,EAAAA,EAAAA,IAAiDoC,EAAA,CA9BzDhD,IAAA,EA8ByBiD,YAAY,a,4DAUrC,GACIC,KAAAA,GACI,MAAMC,GAAOC,EAAAA,EAAAA,KACPhD,GAAWiD,EAAAA,EAAAA,IAAI,IACfP,GAAYO,EAAAA,EAAAA,KAAI,GAChBf,GAAgBe,EAAAA,EAAAA,IAAI,CAAC,GAErBC,EAAWC,UACb,MAAMC,EAAML,EAAKM,YACXC,QAAiBC,EAAAA,EAAAA,GAAIH,GACvBE,IACAtD,EAASwD,MAAQF,EAASG,KAC1BzD,EAASwD,MAAME,SAAQ,CAACxC,EAAGyC,KACvBzB,EAAcsB,MAAMG,IAAO,CAAK,IAExC,EAGE9B,EAAgBvB,IAClB4B,EAAcsB,MAAMlD,IAAU4B,EAAcsB,MAAMlD,EAAM,EAGtD+B,EAAqB/B,IACvB4B,EAAcsB,MAAMlD,IAAS,CAAK,EAGhCqC,EAAgBQ,MAAOS,EAAWC,EAAQvD,KAC5C,MAAM8C,EAAM,GAAGL,EAAKe,kBAAkBD,KAAUD,IAChDlB,EAAUc,OAAQ,EAClB,MAAMF,QAAiBC,EAAAA,EAAAA,GAAIH,GACvBE,KACAS,EAAAA,EAAAA,GAAO,OAAQ,GAAI,MACnB/D,EAASwD,MAAMQ,OAAO1D,EAAO,UACtB4B,EAAcsB,MAAMlD,IAE/BoC,EAAUc,OAAQ,EAClBnB,EAAkB/B,EAAM,EAGtBiB,EAAe0C,IACjB,IACI,MAAMC,EAAO,IAAIC,KAAKF,GAChBG,EAAQF,EAAKG,WAAa,EAC1BC,EAAMJ,EAAKK,UACjB,MAAO,GAAGH,KAASE,IACvB,CAAE,MAAOE,GACL,OAAOP,CACX,GAOJ,OAJAQ,EAAAA,EAAAA,KAAUtB,gBACAD,GAAU,IAGb,CACHlD,WACAuB,cACAmB,YACAb,eACAQ,oBACAM,gBACAT,gBAER,G,UChGJ,MAAMwC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAEzF,O","sources":["webpack://simple_blog/./src/components/comments/MyComments.vue","webpack://simple_blog/./src/components/comments/MyComments.vue?5ace"],"sourcesContent":["<template>\n    <div class=\"my-comments-main\">\n        <div class=\"comments\" v-if=\"initData.length\">\n            <div class=\"comment\" v-for=\"(comment, index) in initData\" :key=\"index\">\n                <router-link :to=\"`/Post/${comment.post?.id}`\" v-if=\"comment.post\" class=\"post-link\">\n                    <pre class=\"content\">帖子： {{ comment.post.title }}</pre>\n                </router-link>\n                <pre v-else class=\"missing-post\">该帖子已经被删除</pre>\n                <pre class=\"my-comment\">你的评论: {{ comment.content }}</pre>\n                <span class=\"time\">{{ change_date(comment.create_time) }}</span>\n                <el-button @click=\"toggleDialog(index)\" class=\"delete-btn\">\n                    删除\n                </el-button>\n                <el-dialog\n                    title=\"确定删除?\"\n                    v-model=\"dialogVisible[index]\"\n                    width=\"30%\"\n                    :before-close=\"() => handleBeforeClose(index)\">\n                    <span>你确定要删除这条评论?</span>\n                    <template #footer>\n                        <span class=\"dialog-footer\">\n                            <el-button @click=\"handleBeforeClose(index)\">取消</el-button>\n                            <el-button type=\"danger\" :loading=\"isSending\"\n                             @click=\"confirmDelete(comment.id, comment.post?.id || '1', index)\"\n                            >删除</el-button>\n                        </span>\n                    </template>\n                </el-dialog>\n            </div>\n        </div>\n        <el-empty v-else description=\"暂无评论记录\"></el-empty>\n    </div>\n</template>\n\n<script>\nimport { ref, onMounted } from 'vue';\nimport { useUrl } from '@/store/useUrl';\nimport { get } from '@/http/httpRequest';\nimport { notice } from '../notice';\n\nexport default {\n    setup() {\n        const urls = useUrl();\n        const initData = ref([]);\n        const isSending = ref(false);\n        const dialogVisible = ref({});\n\n        const initPage = async () => {\n            const url = urls.my_comments;\n            const response = await get(url);\n            if (response) {\n                initData.value = response.data;\n                initData.value.forEach((_, idx) => {\n                    dialogVisible.value[idx] = false;\n                });\n            }\n        };\n\n        const toggleDialog = (index) => {\n            dialogVisible.value[index] = !dialogVisible.value[index];\n        };\n\n        const handleBeforeClose = (index) => {\n            dialogVisible.value[index] = false;\n        };\n\n        const confirmDelete = async (commentId, PostId, index) => {\n            const url = `${urls.deleteComments}/${PostId}/${commentId}`;\n            isSending.value = true;\n            const response = await get(url);\n            if (response) {\n                notice(\"删除成功\", \"\", 1500);\n                initData.value.splice(index, 1);\n                delete dialogVisible.value[index]; // 移除已删除评论对应的对话框状态\n            }\n            isSending.value = false;\n            handleBeforeClose(index);\n        };\n\n        const change_date = (str) => {\n            try {\n                const date = new Date(str);\n                const month = date.getMonth() + 1;\n                const day = date.getDate(); // 使用getDate()而非getDay()以获取正确的日期\n                return `${month}月${day}日`;\n            } catch (e) {\n                return str;\n            }\n        };\n\n        onMounted(async () => {\n            await initPage();\n        });\n\n        return {\n            initData,\n            change_date,\n            isSending,\n            toggleDialog,\n            handleBeforeClose,\n            confirmDelete,\n            dialogVisible\n        };\n    }\n}\n</script>\n<style scoped>\n.my-comments-main {\n    max-width: 800px;\n    margin: 20px auto;\n    padding: 20px;\n    background-color: #fff;\n    border-radius: 8px;\n    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);\n}\n\n.comments {\n    display: flex;\n    flex-direction: column;\n    gap: 20px;\n}\n\n.comment {\n    padding: 15px;\n    border-radius: 4px;\n    background-color: #f9f9f9;\n    position: relative;\n}\n\n.post-link {\n    text-decoration: none;\n    color: #1890ff;\n}\n\n.missing-post {\n    color: #ccc;\n}\n\n.my-comment {\n    font-size: 16px;\n    color: #333;\n    white-space: pre-wrap;\n}\n\n.time {\n    display: block;\n    margin-top: 5px;\n    font-size: 12px;\n    color: #999;\n}\n\n.delete-btn {\n    position: absolute;\n    bottom: 10px;\n    right: 10px;\n    padding: 5px 10px;\n    border: none;\n    background-color: #ff4d4f;\n    color: white;\n    border-radius: 4px;\n    cursor: pointer;\n}\n\n.delete-btn:hover {\n    background-color: #ff7875;\n}\n\n.no-comments {\n    text-align: center;\n    color: #999;\n    font-size: 16px;\n}\n\nhr {\n    margin: 10px 0;\n    border: 0;\n    height: 1px;\n    background-color: #eaeaea;\n}\n</style>","import { render } from \"./MyComments.vue?vue&type=template&id=1211100a&scoped=true\"\nimport script from \"./MyComments.vue?vue&type=script&lang=js\"\nexport * from \"./MyComments.vue?vue&type=script&lang=js\"\n\nimport \"./MyComments.vue?vue&type=style&index=0&id=1211100a&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-1211100a\"]])\n\nexport default __exports__"],"names":["class","key","_createElementBlock","_hoisted_1","$setup","initData","length","_hoisted_2","_Fragment","_renderList","comment","index","post","_createBlock","_component_router_link","to","id","default","_withCtx","_createElementVNode","_hoisted_3","_toDisplayString","title","_","_hoisted_4","_hoisted_5","content","_hoisted_6","change_date","create_time","_createVNode","_component_el_button","onClick","$event","toggleDialog","_cache","_createTextVNode","_component_el_dialog","modelValue","dialogVisible","width","before-close","handleBeforeClose","footer","_hoisted_7","type","loading","isSending","confirmDelete","_component_el_empty","description","setup","urls","useUrl","ref","initPage","async","url","my_comments","response","get","value","data","forEach","idx","commentId","PostId","deleteComments","notice","splice","str","date","Date","month","getMonth","day","getDate","e","onMounted","__exports__","render"],"sourceRoot":""}